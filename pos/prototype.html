<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>å¤¯è‚‰ HANGROU - POS é»é¤ç³»çµ±åŸå‹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            /* ç¦æ­¢è§¸æ§ç¸®æ”¾å’Œæ‰‹å‹¢æ“ä½œ */
            touch-action: manipulation;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        /* å…è¨±è¼¸å…¥æ¡†é¸å–æ–‡å­— */
        input, textarea {
            -webkit-user-select: text;
            user-select: text;
        }

        html {
            /* é˜²æ­¢æ•´é«”é é¢ç¸®æ”¾ */
            touch-action: pan-x pan-y;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans TC", sans-serif;
            background: #F8F9FA;
            color: #2D3436;
            overflow-x: hidden;
            /* é˜²æ­¢é›™æ“Šç¸®æ”¾ */
            touch-action: pan-x pan-y;
            -webkit-overflow-scrolling: touch;
        }

        /* é ‚éƒ¨å°èˆª */
        .header {
            background: #FF6B35;
            color: white;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 20px;
            font-weight: 600;
        }

        .header-buttons {
            display: flex;
            gap: 10px;
        }

        .header-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .header-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        /* åˆ†é¡æ¨™ç±¤ */
        .category-tabs {
            display: flex;
            gap: 8px;
            padding: 12px 20px;
            background: white;
            overflow-x: auto;
            white-space: nowrap;
            border-bottom: 1px solid #DFE6E9;
        }

        .category-tab {
            padding: 8px 20px;
            background: #F8F9FA;
            border: 2px solid #F8F9FA;
            border-radius: 20px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
        }

        .category-tab.active {
            background: #FF6B35;
            color: white;
            border-color: #FF6B35;
        }

        /* ä¸»å…§å®¹å€ */
        .main-content {
            display: flex;
            height: calc(100vh - 140px);
        }

        /* é¸å–®å€åŸŸ */
        .menu-section {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 16px;
        }

        .menu-item {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            cursor: pointer;
            transition: all 0.2s;
        }

        .menu-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.12);
        }

        .menu-item-image {
            width: 100%;
            height: 120px;
            background: linear-gradient(135deg, #FF6B35, #FF8C42);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
        }

        .menu-item-info {
            padding: 12px;
        }

        .menu-item-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .menu-item-desc {
            font-size: 12px;
            color: #636E72;
            margin-bottom: 8px;
        }

        .menu-item-price {
            font-size: 18px;
            color: #FF6B35;
            font-weight: 600;
        }

        /* è³¼ç‰©è»Šå´é‚Šæ¬„ */
        .cart-sidebar {
            width: 380px;
            background: white;
            border-left: 1px solid #DFE6E9;
            display: flex;
            flex-direction: column;
        }

        .cart-header {
            padding: 16px 20px;
            background: #FF8C42;
            color: white;
            font-size: 18px;
            font-weight: 600;
        }

        .cart-items {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
        }

        .cart-item {
            background: #F8F9FA;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .cart-item-price {
            color: #636E72;
            font-size: 14px;
        }

        .cart-item-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quantity-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: #FF6B35;
            color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quantity-btn:hover {
            background: #FF8C42;
        }

        .quantity-display {
            font-weight: 600;
            min-width: 30px;
            text-align: center;
        }

        .delete-btn {
            background: #D63031;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .cart-footer {
            padding: 16px 20px;
            background: #F8F9FA;
            border-top: 1px solid #DFE6E9;
        }

        .cart-summary {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 16px;
        }

        .cart-total {
            font-size: 24px;
            font-weight: 600;
            color: #FF6B35;
        }

        .cart-actions {
            display: flex;
            gap: 8px;
        }

        .btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #FF6B35;
            color: white;
        }

        .btn-primary:hover {
            background: #FF8C42;
        }

        .btn-secondary {
            background: #636E72;
            color: white;
        }

        .btn-secondary:hover {
            background: #2D3436;
        }

        /* çµå¸³å½ˆçª— */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            background: #FF6B35;
            color: white;
            padding: 16px 20px;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        .modal-body {
            padding: 20px;
        }

        .order-info {
            background: #F8F9FA;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 16px;
        }

        .order-info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .checkout-items {
            margin-bottom: 16px;
        }

        .checkout-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #F8F9FA;
        }

        .payment-section {
            margin-top: 20px;
        }

        .payment-method {
            background: #F8F9FA;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .input-group {
            margin-bottom: 16px;
        }

        .input-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .input-field {
            width: 100%;
            padding: 12px;
            border: 2px solid #DFE6E9;
            border-radius: 8px;
            font-size: 16px;
        }

        .input-field:focus {
            outline: none;
            border-color: #FF6B35;
        }

        .quick-amount-buttons {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }

        .quick-amount-btn {
            flex: 1;
            padding: 8px;
            background: #F8F9FA;
            border: 2px solid #F8F9FA;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            /* ç§»é™¤éæ¸¡å‹•ç•«ä»¥æå‡è§¸æ§éŸ¿æ‡‰é€Ÿåº¦ */
            transition: none;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-select: none;
            /* é˜²æ­¢é€£é»æ™‚çš„å»¶é² */
            -webkit-touch-callout: none;
            -webkit-user-drag: none;
        }

        .quick-amount-btn:hover {
            border-color: #FF6B35;
            background: white;
        }

        .quick-amount-btn:active {
            transform: scale(0.95);
            background: #F0F0F0;
        }

        /* æŒ‰éˆ•æŒ‰ä¸‹ç‹€æ…‹ï¼ˆåƒ…ç”¨æ–¼è§¸æ§è£ç½®ï¼‰ */
        .quick-amount-btn.pressed {
            transform: scale(0.95);
            background: #E0E0E0;
        }

        .change-display {
            background: #00B894;
            color: white;
            padding: 16px;
            border-radius: 8px;
            text-align: center;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .modal-actions {
            display: flex;
            gap: 8px;
        }

        /* å ±è¡¨é é¢ */
        .reports-page {
            display: none;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .reports-page.active {
            display: block;
        }

        .reports-header {
            margin-bottom: 20px;
        }

        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .stat-label {
            font-size: 14px;
            color: #636E72;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 600;
            color: #FF6B35;
        }

        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 24px;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .hourly-bar {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        .hourly-label {
            width: 100px;
            font-size: 14px;
        }

        .hourly-bar-bg {
            flex: 1;
            height: 24px;
            background: #F8F9FA;
            border-radius: 4px;
            overflow: hidden;
            margin: 0 12px;
        }

        .hourly-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #FF6B35, #FF8C42);
            transition: width 0.5s;
        }

        .hourly-value {
            width: 80px;
            text-align: right;
            font-weight: 600;
        }

        .top-items-list {
            list-style: none;
        }

        .top-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #F8F9FA;
        }

        .top-item-rank {
            width: 30px;
            height: 30px;
            background: #FF6B35;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-right: 12px;
        }

        .top-item-info {
            flex: 1;
        }

        .top-item-name {
            font-weight: 600;
        }

        .top-item-qty {
            color: #636E72;
            font-size: 14px;
        }

        .top-item-discount {
            color: #D63031;
            font-size: 12px;
            margin-top: 2px;
        }

        .top-item-revenue {
            font-weight: 600;
            color: #FF6B35;
            text-align: right;
        }

        .back-btn {
            background: #636E72;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-bottom: 16px;
        }

        /* ç©ºè³¼ç‰©è»Šç‹€æ…‹ */
        .empty-cart {
            text-align: center;
            padding: 40px 20px;
            color: #636E72;
        }

        .empty-cart-icon {
            font-size: 64px;
            margin-bottom: 16px;
        }

        /* å ±è¡¨é¡å‹åˆ‡æ› */
        .report-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }

        .report-tab {
            flex: 1;
            padding: 12px;
            background: white;
            border: 2px solid #DFE6E9;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }

        .report-tab.active {
            background: #FF6B35;
            color: white;
            border-color: #FF6B35;
        }

        .report-tab:hover:not(.active) {
            border-color: #FF6B35;
        }

        /* å ±è¡¨å…§å®¹å€ */
        .report-content {
            display: none;
        }

        .report-content.active {
            display: block;
        }

        /* åˆ†é¡çµ±è¨ˆ */
        .category-stats {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .category-stat-item {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .category-label {
            width: 100px;
            font-weight: 600;
        }

        .category-bar-bg {
            flex: 1;
            height: 24px;
            background: #F8F9FA;
            border-radius: 4px;
            overflow: hidden;
        }

        .category-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #FF6B35, #FF8C42);
            transition: width 0.5s;
        }

        .category-value {
            width: 80px;
            text-align: right;
            font-weight: 600;
        }

        /* æ™‚æ®µåœ–è¡¨ */
        .hourly-bars {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        /* è¶¨å‹¢åœ–è¡¨ */
        .trend-chart {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 200px;
            padding: 20px 0;
            gap: 8px;
        }

        .trend-bar {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .trend-bar-fill {
            width: 100%;
            background: linear-gradient(180deg, #FF6B35, #FF8C42);
            border-radius: 4px 4px 0 0;
            transition: height 0.5s;
            min-height: 4px;
        }

        .trend-bar-label {
            font-size: 12px;
            color: #636E72;
        }

        .trend-bar-value {
            font-size: 12px;
            font-weight: 600;
            color: #FF6B35;
        }

        /* æˆé•·çµ±è¨ˆ */
        .growth-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .growth-item {
            background: #F8F9FA;
            padding: 16px;
            border-radius: 8px;
            text-align: center;
        }

        .growth-label {
            font-size: 14px;
            color: #636E72;
            margin-bottom: 8px;
        }

        .growth-value {
            font-size: 24px;
            font-weight: 600;
        }

        .growth-value.positive {
            color: #00B894;
        }

        .growth-value.negative {
            color: #D63031;
        }

        /* è¨­å®šé é¢ */
        .settings-page {
            display: none;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        .settings-page.active {
            display: block;
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .settings-header h2 {
            font-size: 24px;
            font-weight: 600;
        }

        .settings-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 24px;
        }

        .settings-section h3 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .section-desc {
            color: #636E72;
            font-size: 14px;
            margin-bottom: 16px;
        }

        .discount-rules-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .discount-rule-card {
            background: #F8F9FA;
            border-radius: 8px;
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 2px solid transparent;
            transition: all 0.2s;
        }

        .discount-rule-card:hover {
            border-color: #FF6B35;
            background: white;
        }

        .discount-rule-info {
            flex: 1;
        }

        .discount-rule-title {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 4px;
        }

        .discount-rule-desc {
            color: #636E72;
            font-size: 14px;
        }

        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            margin-right: 8px;
        }

        .badge-item {
            background: #E3F2FD;
            color: #1976D2;
        }

        .badge-category {
            background: #F3E5F5;
            color: #7B1FA2;
        }

        .badge-total {
            background: #FFF3E0;
            color: #F57C00;
        }

        .discount-rule-actions {
            display: flex;
            gap: 8px;
        }

        .discount-rule-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s;
        }

        .btn-edit {
            background: #0984E3;
            color: white;
        }

        .btn-edit:hover {
            background: #0770C0;
        }

        .btn-delete {
            background: #D63031;
            color: white;
        }

        .btn-delete:hover {
            background: #B02929;
        }

        .empty-rules {
            text-align: center;
            padding: 40px 20px;
            color: #636E72;
        }

        .empty-rules-icon {
            font-size: 48px;
            margin-bottom: 12px;
        }

        /* æŠ˜æ‰£é è¦½ */
        .discount-preview {
            background: linear-gradient(135deg, #FF6B35, #FF8C42);
            color: white;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
        }

        .preview-label {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .preview-text {
            font-size: 20px;
            font-weight: 600;
        }

        /* è³¼ç‰©è»ŠæŠ˜æ‰£é¡¯ç¤º */
        .cart-discount {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #FFF3CD;
            border-radius: 8px;
            margin-bottom: 12px;
            border: 1px solid #FFC107;
        }

        .discount-label {
            font-weight: 600;
            color: #856404;
        }

        .discount-value {
            font-size: 18px;
            font-weight: 600;
            color: #856404;
        }

        select.input-field {
            cursor: pointer;
        }

        /* éŸ¿æ‡‰å¼ */
        @media (max-width: 968px) {
            .main-content {
                flex-direction: column;
            }

            .cart-sidebar {
                width: 100%;
                border-left: none;
                border-top: 1px solid #DFE6E9;
            }
        }
    </style>
</head>
<body>
    <!-- é ‚éƒ¨å°èˆª -->
    <header class="header">
        <h1>å¤¯è‚‰ HANGROU</h1>
        <div class="header-buttons">
            <button class="header-btn" onclick="showReports()">ğŸ“Š å ±è¡¨</button>
            <button class="header-btn" onclick="showSettings()">âš™ï¸ è¨­å®š</button>
        </div>
    </header>

    <!-- ä¸»ç•«é¢ -->
    <div id="mainPage">
        <!-- åˆ†é¡æ¨™ç±¤ -->
        <div class="category-tabs" id="categoryTabs">
            <div class="category-tab active" data-category="all">ğŸ” å…¨éƒ¨</div>
            <div class="category-tab" data-category="beef">ğŸ‚ ç‰›è‚‰</div>
            <div class="category-tab" data-category="pork">ğŸ– è±¬è‚‰</div>
            <div class="category-tab" data-category="chicken">ğŸ” é›è‚‰</div>
            <div class="category-tab" data-category="vegetable">ğŸ¥¬ è”¬èœ</div>
            <div class="category-tab" data-category="skewer">ğŸ¢ ä¸²ç‡’</div>
            <div class="category-tab" data-category="drink">ğŸº é£²æ–™</div>
        </div>

        <!-- ä¸»å…§å®¹å€ -->
        <div class="main-content">
            <!-- é¸å–®å€åŸŸ -->
            <div class="menu-section">
                <div class="menu-grid" id="menuGrid">
                    <!-- èœå“æœƒç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
                </div>
            </div>

            <!-- è³¼ç‰©è»Šå´é‚Šæ¬„ -->
            <div class="cart-sidebar">
                <div class="cart-header">
                    ğŸ›’ ç›®å‰è¨‚å–®
                </div>
                <div class="cart-items" id="cartItems">
                    <div class="empty-cart">
                        <div class="empty-cart-icon">ğŸ›’</div>
                        <p>å°šæœªé»é¸ä»»ä½•å•†å“</p>
                    </div>
                </div>
                <div class="cart-footer">
                    <div class="cart-summary">
                        <span>ç¸½è¨ˆï¼š<span id="totalItems">0</span> ä»¶</span>
                        <span class="cart-total" id="cartTotal">$0</span>
                    </div>
                    <div class="cart-actions">
                        <button class="btn btn-secondary" onclick="clearCart()">æ¸…ç©º</button>
                        <button class="btn btn-primary" onclick="showCheckout()">çµå¸³</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å ±è¡¨é é¢ -->
    <div class="reports-page" id="reportsPage">
        <button class="back-btn" onclick="hideReports()">â† è¿”å›é»é¤</button>

        <div class="reports-header">
            <h2>éŠ·å”®å ±è¡¨</h2>
        </div>

        <!-- å ±è¡¨é¡å‹åˆ‡æ› -->
        <div class="report-tabs">
            <div class="report-tab active" data-report="daily" onclick="switchReport('daily')">æ—¥å ±è¡¨</div>
            <div class="report-tab" data-report="weekly" onclick="switchReport('weekly')">é€±å ±è¡¨</div>
            <div class="report-tab" data-report="monthly" onclick="switchReport('monthly')">æœˆå ±è¡¨</div>
        </div>

        <!-- æ—¥å ±è¡¨ -->
        <div class="report-content active" id="dailyReport">
            <div class="stats-cards">
                <div class="stat-card">
                    <div class="stat-label">ä»Šæ—¥ç‡Ÿæ¥­é¡</div>
                    <div class="stat-value" id="todayRevenue">$0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">è¨‚å–®æ•¸</div>
                    <div class="stat-value" id="todayOrders">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">ä»Šæ—¥ç¸½æŠ˜æ‰£</div>
                    <div class="stat-value" id="todayDiscount" style="color: #D63031;">$0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">ä»Šæ—¥åˆ©æ½¤</div>
                    <div class="stat-value" id="todayProfit" style="color: #00B894;">$0</div>
                </div>
            </div>

            <!-- åˆ†é¡éŠ·å”®å æ¯” -->
            <div class="chart-container">
                <div class="chart-title">å„åˆ†é¡éŠ·å”®å æ¯”</div>
                <div class="category-stats" id="categoryStats">
                    <div class="category-stat-item">
                        <div class="category-label">ğŸ‚ ç‰›è‚‰</div>
                        <div class="category-bar-bg">
                            <div class="category-bar-fill" style="width: 45%; background: linear-gradient(90deg, #FF6B35, #FF8C42);"></div>
                        </div>
                        <div class="category-value">$0</div>
                    </div>
                    <div class="category-stat-item">
                        <div class="category-label">ğŸ– è±¬è‚‰</div>
                        <div class="category-bar-bg">
                            <div class="category-bar-fill" style="width: 30%; background: linear-gradient(90deg, #FF6B35, #FF8C42);"></div>
                        </div>
                        <div class="category-value">$0</div>
                    </div>
                    <div class="category-stat-item">
                        <div class="category-label">ğŸ” é›è‚‰</div>
                        <div class="category-bar-bg">
                            <div class="category-bar-fill" style="width: 15%; background: linear-gradient(90deg, #FF6B35, #FF8C42);"></div>
                        </div>
                        <div class="category-value">$0</div>
                    </div>
                    <div class="category-stat-item">
                        <div class="category-label">ğŸ¥¬ è”¬èœ</div>
                        <div class="category-bar-bg">
                            <div class="category-bar-fill" style="width: 10%; background: linear-gradient(90deg, #FF6B35, #FF8C42);"></div>
                        </div>
                        <div class="category-value">$0</div>
                    </div>
                </div>
            </div>

            <!-- æ™‚æ®µåˆ†å¸ƒ -->
            <div class="chart-container">
                <div class="chart-title">æ¯å°æ™‚ç‡Ÿæ¥­é¡åˆ†æ</div>
                <div class="hourly-bars" id="hourlyBars">
                    <div class="hourly-bar">
                        <div class="hourly-label">17:00</div>
                        <div class="hourly-bar-bg">
                            <div class="hourly-bar-fill" style="width: 0%"></div>
                        </div>
                        <div class="hourly-value">$0</div>
                    </div>
                    <div class="hourly-bar">
                        <div class="hourly-label">18:00</div>
                        <div class="hourly-bar-bg">
                            <div class="hourly-bar-fill" style="width: 0%"></div>
                        </div>
                        <div class="hourly-value">$0</div>
                    </div>
                    <div class="hourly-bar">
                        <div class="hourly-label">19:00</div>
                        <div class="hourly-bar-bg">
                            <div class="hourly-bar-fill" style="width: 0%"></div>
                        </div>
                        <div class="hourly-value">$0</div>
                    </div>
                    <div class="hourly-bar">
                        <div class="hourly-label">20:00</div>
                        <div class="hourly-bar-bg">
                            <div class="hourly-bar-fill" style="width: 0%"></div>
                        </div>
                        <div class="hourly-value">$0</div>
                    </div>
                    <div class="hourly-bar">
                        <div class="hourly-label">21:00</div>
                        <div class="hourly-bar-bg">
                            <div class="hourly-bar-fill" style="width: 0%"></div>
                        </div>
                        <div class="hourly-value">$0</div>
                    </div>
                    <div class="hourly-bar">
                        <div class="hourly-label">22:00</div>
                        <div class="hourly-bar-bg">
                            <div class="hourly-bar-fill" style="width: 0%"></div>
                        </div>
                        <div class="hourly-value">$0</div>
                    </div>
                </div>
            </div>

            <!-- ç†±éŠ·å•†å“ TOP 10 -->
            <div class="chart-container">
                <div class="chart-title">ç†±éŠ·å•†å“ TOP 10</div>
                <ul class="top-items-list" id="topItemsList">
                    <li style="text-align: center; padding: 20px; color: #636E72;">ä»Šæ—¥å°šç„¡éŠ·å”®è¨˜éŒ„</li>
                </ul>
            </div>

            <!-- æŠ˜æ‰£æ˜ç´° -->
            <div class="chart-container">
                <div class="chart-title">æŠ˜æ‰£æ˜ç´°</div>
                <div class="discount-details" id="discountDetails">
                    <div style="text-align: center; padding: 20px; color: #636E72;">ä»Šæ—¥å°šç„¡æŠ˜æ‰£è¨˜éŒ„</div>
                </div>
            </div>
        </div>

        <!-- é€±å ±è¡¨ -->
        <div class="report-content" id="weeklyReport">
            <div class="stats-cards">
                <div class="stat-card">
                    <div class="stat-label">æœ¬é€±ç‡Ÿæ¥­é¡</div>
                    <div class="stat-value" id="weekRevenue">$0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">æœ¬é€±è¨‚å–®æ•¸</div>
                    <div class="stat-value" id="weekOrders">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">æ—¥å‡ç‡Ÿæ¥­é¡</div>
                    <div class="stat-value" id="weekAvg">$0</div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">7å¤©ç‡Ÿæ¥­é¡è¶¨å‹¢åœ–</div>
                <div class="trend-chart" id="weekTrendChart">
                    <!-- æœƒç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">é€±æˆé•·å°æ¯”</div>
                <div class="growth-stats">
                    <div class="growth-item">
                        <div class="growth-label">ç‡Ÿæ¥­é¡æˆé•·</div>
                        <div class="growth-value positive">+0%</div>
                    </div>
                    <div class="growth-item">
                        <div class="growth-label">è¨‚å–®æ•¸æˆé•·</div>
                        <div class="growth-value positive">+0%</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æœˆå ±è¡¨ -->
        <div class="report-content" id="monthlyReport">
            <div class="stats-cards">
                <div class="stat-card">
                    <div class="stat-label">æœ¬æœˆç‡Ÿæ¥­é¡</div>
                    <div class="stat-value" id="monthRevenue">$0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">æœ¬æœˆè¨‚å–®æ•¸</div>
                    <div class="stat-value" id="monthOrders">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">æ—¥å‡ç‡Ÿæ¥­é¡</div>
                    <div class="stat-value" id="monthAvg">$0</div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">æœˆåº¦éŠ·å”®è¶¨å‹¢</div>
                <div class="trend-chart" id="monthTrendChart">
                    <!-- æœƒç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
                </div>
            </div>
        </div>
    </div>

    <!-- çµå¸³å½ˆçª— -->
    <div class="modal-overlay" id="checkoutModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">çµå¸³ä»˜æ¬¾</div>
                <button class="modal-close" onclick="hideCheckout()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="order-info">
                    <div class="order-info-row">
                        <span>è¨‚å–®è™Ÿï¼š</span>
                        <span id="orderNumber">#20260126-001</span>
                    </div>
                    <div class="order-info-row">
                        <span>æ™‚é–“ï¼š</span>
                        <span id="orderTime">2026-01-26 19:35</span>
                    </div>
                </div>

                <div class="checkout-items" id="checkoutItems">
                    <!-- è¨‚å–®é …ç›®æœƒç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
                </div>

                <div class="order-info">
                    <div class="order-info-row">
                        <span>ç¸½è¨ˆï¼š</span>
                        <span class="cart-total" id="checkoutTotal">$0</span>
                    </div>
                </div>

                <div class="payment-section">
                    <div class="payment-method">
                        <span>ğŸ’µ</span>
                        <span>ç¾é‡‘ä»˜æ¬¾</span>
                    </div>

                    <div class="input-group">
                        <label class="input-label">å¯¦æ”¶é‡‘é¡</label>
                        <input type="number" class="input-field" id="receivedAmount" placeholder="è¼¸å…¥é‡‘é¡" oninput="validateNumberInput(this)" min="0" step="1" pattern="\d*">
                        <div class="quick-amount-buttons">
                            <button class="quick-amount-btn" onclick="addAmount(100)">$100</button>
                            <button class="quick-amount-btn" onclick="addAmount(500)">$500</button>
                            <button class="quick-amount-btn" onclick="addAmount(1000)">$1000</button>
                            <button class="quick-amount-btn" onclick="setFullAmount()" style="background: #FF6B35; color: white; border-color: #FF6B35;">ğŸ’° æ”¶å…¨é¡</button>
                            <button class="quick-amount-btn" onclick="clearAmount()" style="background: #D63031; color: white; border-color: #D63031;">ğŸ—‘ï¸ æ­¸é›¶</button>
                        </div>
                    </div>

                    <div class="change-display" id="changeDisplay">
                        æ‰¾é›¶ï¼š$0
                    </div>

                    <div class="modal-actions">
                        <button class="btn btn-secondary" onclick="hideCheckout()">å–æ¶ˆ</button>
                        <button class="btn btn-primary" onclick="completePayment()">ç¢ºèªä»˜æ¬¾</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- è¨­å®šé é¢ -->
    <div class="settings-page" id="settingsPage">
        <div class="settings-header">
            <button class="back-btn" onclick="hideSettings()">â† è¿”å›é»é¤</button>
            <h2>âš™ï¸ ç³»çµ±è¨­å®š</h2>
        </div>

        <div class="settings-content">
            <!-- æŠ˜æ‰£è¦å‰‡è¨­å®š -->
            <div class="settings-section">
                <h3>ğŸ·ï¸ æŠ˜æ‰£è¦å‰‡</h3>
                <p class="section-desc">è¨­å®šè²·å¹¾ä¸²æŠ˜å¤šå°‘çš„å„ªæƒ è¦å‰‡</p>

                <div class="discount-rules-list" id="discountRulesList">
                    <!-- æŠ˜æ‰£è¦å‰‡æœƒç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
                </div>

                <button class="btn btn-primary" onclick="showAddDiscountModal()" style="width: 100%; margin-top: 16px;">
                    + æ–°å¢æŠ˜æ‰£è¦å‰‡
                </button>
            </div>
        </div>
    </div>

    <!-- æ–°å¢/ç·¨è¼¯æŠ˜æ‰£è¦å‰‡å½ˆçª— -->
    <div class="modal-overlay" id="discountModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="discountModalTitle">æ–°å¢æŠ˜æ‰£è¦å‰‡</div>
                <button class="modal-close" onclick="hideDiscountModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label class="input-label">æŠ˜æ‰£é¡å‹</label>
                    <select class="input-field" id="discountType" onchange="onDiscountTypeChange()">
                        <option value="item">å–®ä¸€å“é …æŠ˜æ‰£</option>
                        <option value="category">åˆ†é¡æŠ˜æ‰£</option>
                        <option value="total">ç¸½æ•¸é‡æŠ˜æ‰£</option>
                    </select>
                    <small style="color: #636E72; display: block; margin-top: 4px;" id="discountTypeDesc">
                        æŒ‡å®šå–®ä¸€å•†å“é”åˆ°æ•¸é‡å¾ŒæŠ˜æ‰£
                    </small>
                </div>

                <!-- å–®ä¸€å“é …é¸æ“‡ -->
                <div class="input-group" id="itemSelectGroup">
                    <label class="input-label">é¸æ“‡å“é …</label>
                    <select class="input-field" id="discountItem">
                        <!-- æœƒç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
                    </select>
                </div>

                <!-- åˆ†é¡é¸æ“‡ -->
                <div class="input-group" id="categorySelectGroup" style="display: none;">
                    <label class="input-label">é¸æ“‡åˆ†é¡</label>
                    <select class="input-field" id="discountCategory">
                        <option value="beef">ç‰›è‚‰</option>
                        <option value="pork">è±¬è‚‰</option>
                        <option value="chicken">é›è‚‰</option>
                        <option value="vegetable">è”¬èœ</option>
                        <option value="skewer">ä¸²ç‡’</option>
                        <option value="drink">é£²å“</option>
                    </select>
                </div>

                <div class="input-group">
                    <label class="input-label">è³¼è²·æ•¸é‡</label>
                    <input type="number" class="input-field" id="discountQuantity" min="1" value="3" placeholder="ä¾‹å¦‚ï¼š3" oninput="updateDiscountPreview()">
                </div>

                <div class="input-group">
                    <label class="input-label">æŠ˜æ‰£é‡‘é¡</label>
                    <input type="number" class="input-field" id="discountAmount" min="1" value="5" placeholder="ä¾‹å¦‚ï¼š5" oninput="updateDiscountPreview()">
                    <small style="color: #636E72; display: block; margin-top: 4px;">
                        è²·æ»¿æŒ‡å®šæ•¸é‡ï¼Œå¯æŠ˜æ‰£çš„é‡‘é¡
                    </small>
                </div>

                <div class="discount-preview" id="discountPreview">
                    <div class="preview-label">å„ªæƒ èªªæ˜é è¦½</div>
                    <div class="preview-text" id="discountPreviewText">çƒ¤é¦™è‡ è²·3ä¸² æŠ˜$5</div>
                </div>

                <div class="modal-actions">
                    <button class="btn btn-secondary" onclick="hideDiscountModal()">å–æ¶ˆ</button>
                    <button class="btn btn-primary" onclick="saveDiscountRule()">å„²å­˜</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // èœå“è³‡æ–™
        const menuItems = [
            { id: 1, name: 'ç‰›äº”èŠ±', category: 'beef', price: 120, icon: 'ğŸ¥©', desc: 'æ¾³æ´²é€²å£ç‰›äº”èŠ±' },
            { id: 2, name: 'ç‰›å°æ’', category: 'beef', price: 150, icon: 'ğŸ¥©', desc: 'åšåˆ‡ç‰›å°æ’' },
            { id: 3, name: 'ç‰›èˆŒ', category: 'beef', price: 130, icon: 'ğŸ‘…', desc: 'é¹½çƒ¤ç‰›èˆŒ' },
            { id: 4, name: 'è±¬è‚‹æ’', category: 'pork', price: 80, icon: 'ğŸ–', desc: 'é†ƒè£½è±¬è‚‹æ’' },
            { id: 5, name: 'åŸ¹æ ¹æ²', category: 'pork', price: 50, icon: 'ğŸ¥“', desc: 'åŸ¹æ ¹æ²èŠ¦ç­' },
            { id: 6, name: 'é¦™è…¸', category: 'pork', price: 40, icon: 'ğŸŒ­', desc: 'å°å¼é¦™è…¸' },
            { id: 7, name: 'é›è‚‰ä¸²', category: 'chicken', price: 50, icon: 'ğŸ¢', desc: 'æ–°é®®é›è…¿è‚‰' },
            { id: 8, name: 'é›ç¿…', category: 'chicken', price: 60, icon: 'ğŸ—', desc: 'é¹½çƒ¤é›ç¿…' },
            { id: 9, name: 'çƒ¤ç‰ç±³', category: 'vegetable', price: 40, icon: 'ğŸŒ½', desc: 'ç¢³çƒ¤ç‰ç±³' },
            { id: 10, name: 'çƒ¤é’æ¤’', category: 'vegetable', price: 30, icon: 'ğŸ«‘', desc: 'é’æ¤’å¡è‚‰' },
            { id: 11, name: 'ä¸²ç‡’çµ„åˆ', category: 'skewer', price: 100, icon: 'ğŸ¢', desc: 'ç¶œåˆä¸²ç‡’' },
            { id: 12, name: 'çƒ¤é¦™è‡', category: 'vegetable', price: 35, icon: 'ğŸ„', desc: 'ç¢³çƒ¤é¦™è‡' },
            { id: 13, name: 'å¯æ¨‚', category: 'drink', price: 30, icon: 'ğŸ¥¤', desc: 'å¯å£å¯æ¨‚' },
            { id: 14, name: 'å•¤é…’', category: 'drink', price: 60, icon: 'ğŸº', desc: 'å°ç£å•¤é…’' },
        ];

        // è³¼ç‰©è»Šè³‡æ–™
        let cart = [];
        let currentCategory = 'all';
        let orderCount = 1;

        // ç•¶æ—¥éŠ·å”®çµ±è¨ˆ
        let dailyStats = {
            date: new Date().toISOString().split('T')[0],
            totalRevenue: 0,         // åŸåƒ¹ç‡Ÿæ¥­é¡ï¼ˆæœªæŠ˜æ‰£ï¼‰
            totalDiscount: 0,        // ç¸½æŠ˜æ‰£é‡‘é¡
            orderCount: 0,
            orders: [],
            hourlyData: {
                '17': 0, '18': 0, '19': 0, '20': 0, '21': 0, '22': 0, '23': 0
            },
            itemSales: {},  // å•†å“éŠ·å”®çµ±è¨ˆ {itemId: {name, quantity, revenue}}
            categorySales: {
                beef: 0,
                pork: 0,
                chicken: 0,
                vegetable: 0,
                skewer: 0,
                drink: 0
            }
        };

        // é€±çµ±è¨ˆï¼ˆæ¨¡æ“¬è³‡æ–™ï¼‰
        let weeklyStats = {
            dailyData: [],  // éå»7å¤©çš„è³‡æ–™
            totalRevenue: 0,
            totalOrders: 0,
            prevWeekRevenue: 0,
            prevWeekOrders: 0
        };

        // æœˆçµ±è¨ˆï¼ˆæ¨¡æ“¬è³‡æ–™ï¼‰
        let monthlyStats = {
            dailyData: [],  // ç•¶æœˆæ¯å¤©çš„è³‡æ–™
            totalRevenue: 0,
            totalOrders: 0
        };

        // æŠ˜æ‰£è¦å‰‡
        let discountRules = [
            {
                id: 1,
                type: 'item', // 'item' | 'category' | 'total'
                itemId: 12,
                itemName: 'çƒ¤é¦™è‡',
                quantity: 3,
                discountAmount: 5
            }
        ];

        let editingDiscountId = null;

        // æŠ˜æ‰£é¡å‹è¨­å®š
        const discountTypes = {
            item: { name: 'å–®ä¸€å“é …', desc: 'æŒ‡å®šå–®ä¸€å•†å“é”åˆ°æ•¸é‡å¾ŒæŠ˜æ‰£' },
            category: { name: 'åˆ†é¡æŠ˜æ‰£', desc: 'åŒåˆ†é¡å•†å“ç¸½æ•¸é”åˆ°æ•¸é‡å¾ŒæŠ˜æ‰£' },
            total: { name: 'ç¸½æ•¸é‡', desc: 'è³¼ç‰©è»Šç¸½æ•¸é”åˆ°æ•¸é‡å¾ŒæŠ˜æ‰£' }
        };

        // åˆ†é¡å°æ‡‰è¡¨
        const categoryNames = {
            beef: 'ç‰›è‚‰',
            pork: 'è±¬è‚‰',
            chicken: 'é›è‚‰',
            vegetable: 'è”¬èœ',
            skewer: 'ä¸²ç‡’',
            drink: 'é£²å“'
        };

        // åˆå§‹åŒ–é¸å–®
        function initMenu() {
            const menuGrid = document.getElementById('menuGrid');
            menuGrid.innerHTML = '';

            const filteredItems = currentCategory === 'all'
                ? menuItems
                : menuItems.filter(item => item.category === currentCategory);

            filteredItems.forEach(item => {
                const menuItem = document.createElement('div');
                menuItem.className = 'menu-item';
                menuItem.innerHTML = `
                    <div class="menu-item-image">${item.icon}</div>
                    <div class="menu-item-info">
                        <div class="menu-item-name">${item.name}</div>
                        <div class="menu-item-desc">${item.desc}</div>
                        <div class="menu-item-price">$${item.price}</div>
                    </div>
                `;
                menuItem.onclick = () => addToCart(item);
                menuGrid.appendChild(menuItem);
            });
        }

        // åˆå§‹åŒ–åˆ†é¡æ¨™ç±¤
        function initCategoryTabs() {
            const tabs = document.querySelectorAll('.category-tab');
            tabs.forEach(tab => {
                tab.onclick = () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    currentCategory = tab.dataset.category;
                    initMenu();
                };
            });
        }

        // æ–°å¢åˆ°è³¼ç‰©è»Š
        function addToCart(item) {
            const existingItem = cart.find(i => i.id === item.id);
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({ ...item, quantity: 1 });
            }
            updateCart();
        }

        // è¨ˆç®—æŠ˜æ‰£ç¸½é¡
        function calculateDiscounts() {
            let totalDiscount = 0;
            const appliedDiscounts = [];

            discountRules.forEach(rule => {
                if (rule.type === 'item') {
                    // å–®ä¸€å“é …æŠ˜æ‰£
                    const cartItem = cart.find(item => item.id === rule.itemId);
                    if (cartItem && cartItem.quantity >= rule.quantity) {
                        const times = Math.floor(cartItem.quantity / rule.quantity);
                        const discount = times * rule.discountAmount;
                        totalDiscount += discount;
                        appliedDiscounts.push({
                            type: 'item',
                            itemName: rule.itemName,
                            quantity: rule.quantity,
                            times: times,
                            discount: discount,
                            description: `${rule.itemName} è²·${rule.quantity}ä¸²æŠ˜$${rule.discountAmount}`
                        });
                    }
                } else if (rule.type === 'category') {
                    // åˆ†é¡æŠ˜æ‰£
                    const categoryItems = cart.filter(item => item.category === rule.categoryId);
                    const totalQuantity = categoryItems.reduce((sum, item) => sum + item.quantity, 0);

                    if (totalQuantity >= rule.quantity) {
                        const times = Math.floor(totalQuantity / rule.quantity);
                        const discount = times * rule.discountAmount;
                        totalDiscount += discount;
                        appliedDiscounts.push({
                            type: 'category',
                            itemName: `${categoryNames[rule.categoryId]}é¡`,
                            quantity: rule.quantity,
                            times: times,
                            discount: discount,
                            description: `${categoryNames[rule.categoryId]} è²·${rule.quantity}ä¸²æŠ˜$${rule.discountAmount} (å…±${totalQuantity}ä¸²)`
                        });
                    }
                } else if (rule.type === 'total') {
                    // ç¸½æ•¸é‡æŠ˜æ‰£
                    const totalQuantity = cart.reduce((sum, item) => sum + item.quantity, 0);

                    if (totalQuantity >= rule.quantity) {
                        const times = Math.floor(totalQuantity / rule.quantity);
                        const discount = times * rule.discountAmount;
                        totalDiscount += discount;
                        appliedDiscounts.push({
                            type: 'total',
                            itemName: 'å…¨é¤¨å•†å“',
                            quantity: rule.quantity,
                            times: times,
                            discount: discount,
                            description: `å…¨é¤¨ è²·${rule.quantity}ä¸²æŠ˜$${rule.discountAmount} (å…±${totalQuantity}ä¸²)`
                        });
                    }
                }
            });

            return { totalDiscount, appliedDiscounts };
        }

        // æ›´æ–°è³¼ç‰©è»Šé¡¯ç¤º
        function updateCart() {
            const cartItemsContainer = document.getElementById('cartItems');
            const totalItemsEl = document.getElementById('totalItems');
            const cartTotalEl = document.getElementById('cartTotal');

            if (cart.length === 0) {
                cartItemsContainer.innerHTML = `
                    <div class="empty-cart">
                        <div class="empty-cart-icon">ğŸ›’</div>
                        <p>å°šæœªé»é¸ä»»ä½•å•†å“</p>
                    </div>
                `;
                totalItemsEl.textContent = '0';
                cartTotalEl.textContent = '$0';
                return;
            }

            cartItemsContainer.innerHTML = '';
            let subtotal = 0;
            let totalQuantity = 0;

            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;
                totalQuantity += item.quantity;

                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-price">$${item.price} Ã— ${item.quantity} = $${itemTotal}</div>
                    </div>
                    <div class="cart-item-actions">
                        <button class="quantity-btn" onclick="updateQuantity(${item.id}, -1)">-</button>
                        <div class="quantity-display">${item.quantity}</div>
                        <button class="quantity-btn" onclick="updateQuantity(${item.id}, 1)">+</button>
                        <button class="delete-btn" onclick="removeFromCart(${item.id})">åˆªé™¤</button>
                    </div>
                `;
                cartItemsContainer.appendChild(cartItem);
            });

            // è¨ˆç®—æŠ˜æ‰£
            const { totalDiscount, appliedDiscounts } = calculateDiscounts();

            // é¡¯ç¤ºæŠ˜æ‰£è³‡è¨Š
            if (totalDiscount > 0) {
                const discountDiv = document.createElement('div');
                discountDiv.className = 'cart-discount';
                discountDiv.innerHTML = `
                    <div class="discount-label">ğŸ·ï¸ æŠ˜æ‰£å„ªæƒ </div>
                    <div class="discount-value">-$${totalDiscount}</div>
                `;
                cartItemsContainer.appendChild(discountDiv);

                // é¡¯ç¤ºæŠ˜æ‰£èªªæ˜
                appliedDiscounts.forEach(discount => {
                    const discountInfo = document.createElement('div');
                    discountInfo.style.cssText = 'padding: 8px 12px; font-size: 12px; color: #636E72; background: #FFF3CD; border-radius: 4px; margin-top: 4px;';
                    discountInfo.textContent = discount.description;
                    cartItemsContainer.appendChild(discountInfo);
                });
            }

            const total = subtotal - totalDiscount;
            totalItemsEl.textContent = totalQuantity;
            cartTotalEl.textContent = `$${total}`;
        }

        // æ›´æ–°æ•¸é‡
        function updateQuantity(id, change) {
            const item = cart.find(i => i.id === id);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(id);
                } else {
                    updateCart();
                }
            }
        }

        // å¾è³¼ç‰©è»Šç§»é™¤
        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            updateCart();
        }

        // æ¸…ç©ºè³¼ç‰©è»Š
        function clearCart() {
            if (confirm('ç¢ºå®šè¦æ¸…ç©ºè¨‚å–®å—ï¼Ÿ')) {
                cart = [];
                updateCart();
            }
        }

        // é¡¯ç¤ºçµå¸³å½ˆçª—
        function showCheckout() {
            if (cart.length === 0) {
                alert('è«‹å…ˆé»é¸å•†å“');
                return;
            }

            const modal = document.getElementById('checkoutModal');
            const checkoutItems = document.getElementById('checkoutItems');
            const checkoutTotal = document.getElementById('checkoutTotal');
            const orderNumber = document.getElementById('orderNumber');
            const orderTime = document.getElementById('orderTime');

            // æ›´æ–°è¨‚å–®è™Ÿå’Œæ™‚é–“
            const now = new Date();
            const dateStr = now.toISOString().split('T')[0].replace(/-/g, '');
            const timeStr = now.toTimeString().slice(0, 5);
            orderNumber.textContent = `#${dateStr}-${String(orderCount).padStart(3, '0')}`;
            orderTime.textContent = `${dateStr.slice(0, 4)}-${dateStr.slice(4, 6)}-${dateStr.slice(6, 8)} ${timeStr}`;

            // é¡¯ç¤ºè¨‚å–®é …ç›®
            checkoutItems.innerHTML = '';
            let subtotal = 0;

            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;

                const checkoutItem = document.createElement('div');
                checkoutItem.className = 'checkout-item';
                checkoutItem.innerHTML = `
                    <div>
                        <strong>${item.name}</strong>
                        <span style="margin-left: 8px; color: #636E72;">Ã— ${item.quantity}</span>
                    </div>
                    <div>$${itemTotal}</div>
                `;
                checkoutItems.appendChild(checkoutItem);
            });

            // è¨ˆç®—ä¸¦é¡¯ç¤ºæŠ˜æ‰£
            const { totalDiscount, appliedDiscounts } = calculateDiscounts();

            if (totalDiscount > 0) {
                const discountDiv = document.createElement('div');
                discountDiv.className = 'checkout-item';
                discountDiv.style.cssText = 'background: #FFF3CD; color: #856404;';
                discountDiv.innerHTML = `
                    <div>
                        <strong>ğŸ·ï¸ æŠ˜æ‰£å„ªæƒ </strong>
                    </div>
                    <div style="color: #856404;">-$${totalDiscount}</div>
                `;
                checkoutItems.appendChild(discountDiv);

                // é¡¯ç¤ºæŠ˜æ‰£æ˜ç´°
                appliedDiscounts.forEach(discount => {
                    const discountInfo = document.createElement('div');
                    discountInfo.style.cssText = 'padding: 8px 12px; font-size: 12px; color: #636E72; background: #F8F9FA;';
                    discountInfo.textContent = discount.description;
                    checkoutItems.appendChild(discountInfo);
                });
            }

            const total = subtotal - totalDiscount;
            checkoutTotal.textContent = `$${total}`;

            // é‡ç½®è¼¸å…¥
            document.getElementById('receivedAmount').value = '';
            document.getElementById('changeDisplay').textContent = 'æ‰¾é›¶ï¼š$0';

            modal.classList.add('active');
        }

        // éš±è—çµå¸³å½ˆçª—
        function hideCheckout() {
            document.getElementById('checkoutModal').classList.remove('active');
        }

        // è¨­å®šå¿«é€Ÿé‡‘é¡ï¼ˆç›´æ¥è¨­å®šï¼‰
        function setAmount(amount) {
            document.getElementById('receivedAmount').value = amount;
            calculateChange();
        }

        // ç´¯åŠ é‡‘é¡ï¼ˆæŒ‰éˆ•å¯ç´¯åŠ ï¼‰
        function addAmount(amount) {
            const input = document.getElementById('receivedAmount');
            const current = parseInt(input.value) || 0;
            const newValue = current + amount;
            input.value = newValue;

            // ç›´æ¥è¨ˆç®—æ‰¾é›¶ï¼Œé¿å…é‡è¤‡è¨ˆç®—å°è¨ˆå’ŒæŠ˜æ‰£
            const receivedInput = document.getElementById('receivedAmount');
            const changeDisplay = document.getElementById('changeDisplay');
            const received = parseInt(receivedInput.value) || 0;

            // å¾å…¨åŸŸè®Šæ•¸æˆ–è¨ˆç®—ç¸½é¡
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const { totalDiscount } = calculateDiscounts();
            const total = subtotal - totalDiscount;

            const change = received - total;
            if (change >= 0) {
                changeDisplay.textContent = `æ‰¾é›¶ï¼š$${change}`;
                changeDisplay.style.background = '#00B894';
            } else {
                changeDisplay.textContent = `é‡‘é¡ä¸è¶³ï¼šå·® $${Math.abs(change)}`;
                changeDisplay.style.background = '#D63031';
            }
        }

        // æ”¶å…¨é¡
        function setFullAmount() {
            // è¨ˆç®—å°è¨ˆå’ŒæŠ˜æ‰£
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const { totalDiscount } = calculateDiscounts();
            const total = subtotal - totalDiscount;

            // å››æ¨äº”å…¥åˆ°æ•´æ•¸
            const fullAmount = Math.round(total);
            const input = document.getElementById('receivedAmount');
            input.value = fullAmount;

            // ç«‹å³æ›´æ–°æ‰¾é›¶é¡¯ç¤º
            const changeDisplay = document.getElementById('changeDisplay');
            changeDisplay.textContent = 'æ‰¾é›¶ï¼š$0';
            changeDisplay.style.background = '#00B894';
        }

        // æ¸…é™¤é‡‘é¡ï¼ˆæ­¸é›¶ï¼‰
        function clearAmount() {
            const input = document.getElementById('receivedAmount');
            input.value = '';

            // ç«‹å³é‡ç½®æ‰¾é›¶é¡¯ç¤º
            const changeDisplay = document.getElementById('changeDisplay');
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const { totalDiscount } = calculateDiscounts();
            const total = subtotal - totalDiscount;

            changeDisplay.textContent = `é‡‘é¡ä¸è¶³ï¼šå·® $${total}`;
            changeDisplay.style.background = '#D63031';
        }

        // é©—è­‰æ•¸å­—è¼¸å…¥
        function validateNumberInput(input) {
            // ç§»é™¤éæ•¸å­—å­—å…ƒï¼ˆå…è¨±ç©ºå­—ä¸²ä»¥ä¾¿æ¸…é™¤ï¼‰
            const value = input.value.replace(/[^\d]/g, '');
            input.value = value;
            calculateChange();
        }

        // è¨ˆç®—æ‰¾é›¶
        function calculateChange() {
            const receivedInput = document.getElementById('receivedAmount');
            const changeDisplay = document.getElementById('changeDisplay');

            // è¨ˆç®—å°è¨ˆå’ŒæŠ˜æ‰£
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const { totalDiscount } = calculateDiscounts();
            const total = subtotal - totalDiscount;

            const received = parseInt(receivedInput.value) || 0;

            const change = received - total;
            if (change >= 0) {
                changeDisplay.textContent = `æ‰¾é›¶ï¼š$${change}`;
                changeDisplay.style.background = '#00B894';
            } else {
                changeDisplay.textContent = `é‡‘é¡ä¸è¶³ï¼šå·® $${Math.abs(change)}`;
                changeDisplay.style.background = '#D63031';
            }
        }

        // å®Œæˆä»˜æ¬¾
        function completePayment() {
            // è¨ˆç®—å°è¨ˆå’ŒæŠ˜æ‰£
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const { totalDiscount } = calculateDiscounts();
            const total = subtotal - totalDiscount;

            const received = parseInt(document.getElementById('receivedAmount').value) || 0;

            if (received < total) {
                alert('å¯¦æ”¶é‡‘é¡ä¸è¶³ï¼');
                return;
            }

            // è¨˜éŒ„è¨‚å–®åˆ°çµ±è¨ˆè³‡æ–™
            const now = new Date();
            const hour = now.getHours().toString();
            const dateStr = now.toISOString().split('T')[0];

            // æª¢æŸ¥æ˜¯å¦æ–°çš„ä¸€å¤©
            if (dailyStats.date !== dateStr) {
                dailyStats = {
                    date: dateStr,
                    totalRevenue: 0,
                    totalDiscount: 0,
                    orderCount: 0,
                    orders: [],
                    hourlyData: {
                        '17': 0, '18': 0, '19': 0, '20': 0, '21': 0, '22': 0, '23': 0
                    },
                    itemSales: {},
                    categorySales: {
                        beef: 0,
                        pork: 0,
                        chicken: 0,
                        vegetable: 0,
                        skewer: 0,
                        drink: 0
                    }
                };
            }

            // æ›´æ–°çµ±è¨ˆï¼ˆtotalRevenue è¨˜éŒ„åŸåƒ¹ï¼ŒtotalDiscount è¨˜éŒ„æŠ˜æ‰£ï¼‰
            dailyStats.totalRevenue += subtotal;
            dailyStats.totalDiscount += totalDiscount;
            dailyStats.orderCount++;

            // æ›´æ–°æ™‚æ®µè³‡æ–™ï¼ˆä½¿ç”¨åŸåƒ¹ï¼‰
            if (dailyStats.hourlyData.hasOwnProperty(hour)) {
                dailyStats.hourlyData[hour] += subtotal;
            }

            // æ›´æ–°å•†å“éŠ·å”®çµ±è¨ˆå’Œåˆ†é¡çµ±è¨ˆ
            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;

                // è¨ˆç®—è©²å“é …çš„æŠ˜æ‰£é‡‘é¡
                let itemDiscount = 0;
                discountRules.forEach(rule => {
                    if (rule.type === 'item' && rule.itemId === item.id) {
                        const times = Math.floor(item.quantity / rule.quantity);
                        itemDiscount += times * rule.discountAmount;
                    }
                });

                // å•†å“çµ±è¨ˆ
                if (!dailyStats.itemSales[item.id]) {
                    dailyStats.itemSales[item.id] = {
                        name: item.name,
                        quantity: 0,
                        revenue: 0,
                        discount: 0
                    };
                }
                dailyStats.itemSales[item.id].quantity += item.quantity;
                dailyStats.itemSales[item.id].revenue += itemTotal;
                dailyStats.itemSales[item.id].discount += itemDiscount;

                // åˆ†é¡çµ±è¨ˆ
                if (dailyStats.categorySales.hasOwnProperty(item.category)) {
                    dailyStats.categorySales[item.category] += itemTotal;
                }
            });

            // è¨˜éŒ„è¨‚å–®
            dailyStats.orders.push({
                orderNumber: document.getElementById('orderNumber').textContent,
                time: now.toTimeString().slice(0, 8),
                items: cart.map(i => ({ name: i.name, quantity: i.quantity, price: i.price })),
                subtotal: subtotal,
                discount: totalDiscount,
                total: total
            });

            // é¡¯ç¤ºå®Œæˆè¨Šæ¯
            alert(`âœ… ä»˜æ¬¾å®Œæˆï¼\n\nè¨‚å–®å·²è‡ªå‹•åˆ—å°å»šæˆ¿å–®å’Œå®¢æˆ¶å°ç¥¨`);

            // æ¸…ç©ºè³¼ç‰©è»Š
            cart = [];
            orderCount++;
            updateCart();

            // é—œé–‰å½ˆçª—
            hideCheckout();
        }

        // é¡¯ç¤ºå ±è¡¨é é¢
        function showReports() {
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('settingsPage').classList.remove('active');
            document.getElementById('reportsPage').classList.add('active');
            // é è¨­é¡¯ç¤ºæ—¥å ±è¡¨
            updateDailyReport();
        }

        // åˆ‡æ›å ±è¡¨é¡å‹
        function switchReport(type) {
            // ç§»é™¤æ‰€æœ‰ active
            document.querySelectorAll('.report-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.report-content').forEach(content => {
                content.classList.remove('active');
            });

            // è¨­å®š active
            document.querySelector(`.report-tab[data-report="${type}"]`).classList.add('active');
            document.getElementById(`${type}Report`).classList.add('active');

            // æ›´æ–°å°æ‡‰å ±è¡¨è³‡æ–™
            if (type === 'daily') {
                updateDailyReport();
            } else if (type === 'weekly') {
                updateWeeklyReport();
            } else if (type === 'monthly') {
                updateMonthlyReport();
            }
        }

        // æ›´æ–°æ—¥å ±è¡¨
        function updateDailyReport() {
            // çµ±è¨ˆå¡ç‰‡
            document.getElementById('todayRevenue').textContent = `$${dailyStats.totalRevenue.toLocaleString()}`;
            document.getElementById('todayOrders').textContent = dailyStats.orderCount;
            document.getElementById('todayDiscount').textContent = `-$${dailyStats.totalDiscount.toLocaleString()}`;

            // ä»Šæ—¥åˆ©æ½¤ = åŸåƒ¹ç‡Ÿæ¥­é¡ - ç¸½æŠ˜æ‰£
            const profit = dailyStats.totalRevenue - dailyStats.totalDiscount;
            document.getElementById('todayProfit').textContent = `$${profit.toLocaleString()}`;

            // åˆ†é¡éŠ·å”®å æ¯”
            const totalCategoryRevenue = Object.values(dailyStats.categorySales).reduce((sum, val) => sum + val, 0) || 1;
            const categoryLabels = {
                beef: 'ğŸ‚ ç‰›è‚‰',
                pork: 'ğŸ– è±¬è‚‰',
                chicken: 'ğŸ” é›è‚‰',
                vegetable: 'ğŸ¥¬ è”¬èœ'
            };

            const categoryStatsEl = document.getElementById('categoryStats');
            categoryStatsEl.innerHTML = '';

            Object.entries(categoryLabels).forEach(([key, label]) => {
                const revenue = dailyStats.categorySales[key] || 0;
                const percentage = (revenue / totalCategoryRevenue) * 100;

                const item = document.createElement('div');
                item.className = 'category-stat-item';
                item.innerHTML = `
                    <div class="category-label">${label}</div>
                    <div class="category-bar-bg">
                        <div class="category-bar-fill" style="width: ${percentage}%"></div>
                    </div>
                    <div class="category-value">$${revenue}</div>
                `;
                categoryStatsEl.appendChild(item);
            });

            // æ™‚æ®µåˆ†å¸ƒ
            const maxHourlyRevenue = Math.max(...Object.values(dailyStats.hourlyData), 1);
            const hourlyBarsEl = document.getElementById('hourlyBars');
            hourlyBarsEl.innerHTML = '';

            for (let hour = 17; hour <= 22; hour++) {
                const revenue = dailyStats.hourlyData[hour.toString()] || 0;
                const percentage = (revenue / maxHourlyRevenue) * 100;

                const bar = document.createElement('div');
                bar.className = 'hourly-bar';
                bar.innerHTML = `
                    <div class="hourly-label">${hour}:00</div>
                    <div class="hourly-bar-bg">
                        <div class="hourly-bar-fill" style="width: ${percentage}%"></div>
                    </div>
                    <div class="hourly-value">$${revenue}</div>
                `;
                hourlyBarsEl.appendChild(bar);
            }

            // ç†±éŠ·å•†å“ TOP 10
            const topItemsListEl = document.getElementById('topItemsList');
            topItemsListEl.innerHTML = '';

            const sortedItems = Object.values(dailyStats.itemSales)
                .sort((a, b) => b.revenue - a.revenue)
                .slice(0, 10);

            if (sortedItems.length === 0) {
                topItemsListEl.innerHTML = '<li style="text-align: center; padding: 20px; color: #636E72;">ä»Šæ—¥å°šç„¡éŠ·å”®è¨˜éŒ„</li>';
            } else {
                sortedItems.forEach((item, index) => {
                    const li = document.createElement('li');
                    li.className = 'top-item';

                    li.innerHTML = `
                        <div class="top-item-rank">${index + 1}</div>
                        <div class="top-item-info">
                            <div class="top-item-name">${item.name}</div>
                            <div class="top-item-qty">${item.quantity} ä»½</div>
                        </div>
                        <div class="top-item-revenue">
                            <div style="font-size: 16px; font-weight: 600; color: #2D3436;">$${item.revenue.toLocaleString()}</div>
                        </div>
                    `;
                    topItemsListEl.appendChild(li);
                });
            }

            // æŠ˜æ‰£æ˜ç´°
            updateDiscountDetails();
        }

        // æ›´æ–°æŠ˜æ‰£æ˜ç´°
        function updateDiscountDetails() {
            const discountDetailsEl = document.getElementById('discountDetails');
            discountDetailsEl.innerHTML = '';

            if (dailyStats.totalDiscount === 0) {
                discountDetailsEl.innerHTML = '<div style="text-align: center; padding: 20px; color: #636E72;">ä»Šæ—¥å°šç„¡æŠ˜æ‰£è¨˜éŒ„</div>';
                return;
            }

            // çµ±è¨ˆæ¯å€‹æŠ˜æ‰£è¦å‰‡çš„ä½¿ç”¨æƒ…æ³
            const discountUsage = {};

            dailyStats.orders.forEach(order => {
                if (order.discount > 0) {
                    // åˆ†æé€™ç­†è¨‚å–®ä½¿ç”¨äº†å“ªäº›æŠ˜æ‰£
                    // æš«æ™‚ç°¡åŒ–è™•ç†ï¼šç›´æ¥é¡¯ç¤ºç¸½æŠ˜æ‰£
                    const key = 'ç¸½æŠ˜æ‰£';
                    if (!discountUsage[key]) {
                        discountUsage[key] = {
                            count: 0,
                            totalDiscount: 0
                        };
                    }
                    discountUsage[key].count++;
                    discountUsage[key].totalDiscount += order.discount;
                }
            });

            // æ ¹æ“šå¯¦éš›çš„æŠ˜æ‰£è¦å‰‡çµ±è¨ˆ
            const ruleUsage = {};
            discountRules.forEach(rule => {
                ruleUsage[rule.id] = {
                    name: '',
                    count: 0,
                    totalDiscount: 0
                };

                if (rule.type === 'item') {
                    ruleUsage[rule.id].name = `${rule.itemName} è²·${rule.quantity}ä¸²æŠ˜$${rule.discountAmount}`;

                    // è¨ˆç®—è©²è¦å‰‡ä½¿ç”¨æ¬¡æ•¸
                    dailyStats.orders.forEach(order => {
                        const item = order.items.find(i => i.name === rule.itemName);
                        if (item) {
                            const times = Math.floor(item.quantity / rule.quantity);
                            if (times > 0) {
                                ruleUsage[rule.id].count += times;
                                ruleUsage[rule.id].totalDiscount += times * rule.discountAmount;
                            }
                        }
                    });
                } else if (rule.type === 'category') {
                    ruleUsage[rule.id].name = `${categoryNames[rule.categoryId]} è²·${rule.quantity}ä¸²æŠ˜$${rule.discountAmount}`;

                    // è¨ˆç®—è©²åˆ†é¡è¦å‰‡ä½¿ç”¨æ¬¡æ•¸ï¼ˆç°¡åŒ–è™•ç†ï¼‰
                    let categoryQty = 0;
                    dailyStats.orders.forEach(order => {
                        order.items.forEach(item => {
                            const menuItem = menuItems.find(m => m.name === item.name);
                            if (menuItem && menuItem.category === rule.categoryId) {
                                categoryQty += item.quantity;
                            }
                        });
                    });
                    const times = Math.floor(categoryQty / rule.quantity);
                    ruleUsage[rule.id].count = times;
                    ruleUsage[rule.id].totalDiscount = times * rule.discountAmount;
                } else if (rule.type === 'total') {
                    ruleUsage[rule.id].name = `å…¨é¤¨ è²·${rule.quantity}ä¸²æŠ˜$${rule.discountAmount}`;

                    // è¨ˆç®—ç¸½æ•¸é‡è¦å‰‡ä½¿ç”¨æ¬¡æ•¸
                    let totalQty = 0;
                    dailyStats.orders.forEach(order => {
                        order.items.forEach(item => {
                            totalQty += item.quantity;
                        });
                    });
                    const times = Math.floor(totalQty / rule.quantity);
                    ruleUsage[rule.id].count = times;
                    ruleUsage[rule.id].totalDiscount = times * rule.discountAmount;
                }
            });

            // é¡¯ç¤ºæŠ˜æ‰£æ˜ç´°
            let hasDiscount = false;
            Object.values(ruleUsage).forEach(usage => {
                if (usage.count > 0) {
                    hasDiscount = true;
                    const detailDiv = document.createElement('div');
                    detailDiv.className = 'discount-detail-item';
                    detailDiv.style.cssText = 'display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #FFF3CD; border-radius: 6px; margin-bottom: 8px;';
                    detailDiv.innerHTML = `
                        <div style="flex: 1;">
                            <div style="font-weight: 600; color: #2D3436; margin-bottom: 4px;">${usage.name}</div>
                            <div style="font-size: 13px; color: #636E72;">å¥—ç”¨ ${usage.count} æ¬¡</div>
                        </div>
                        <div style="font-size: 18px; font-weight: 700; color: #D63031;">-$${usage.totalDiscount.toLocaleString()}</div>
                    `;
                    discountDetailsEl.appendChild(detailDiv);
                }
            });

            if (!hasDiscount) {
                discountDetailsEl.innerHTML = '<div style="text-align: center; padding: 20px; color: #636E72;">ä»Šæ—¥å°šç„¡æŠ˜æ‰£è¨˜éŒ„</div>';
            }
        }

        // æ›´æ–°é€±å ±è¡¨
        function updateWeeklyReport() {
            // çµåˆä»Šæ—¥è³‡æ–™è¨ˆç®—é€±çµ±è¨ˆ
            const weekRevenue = dailyStats.totalRevenue + 54320; // æ¨¡æ“¬å‰6å¤©
            const weekOrders = dailyStats.orderCount + 248; // æ¨¡æ“¬å‰6å¤©

            document.getElementById('weekRevenue').textContent = `$${weekRevenue.toLocaleString()}`;
            document.getElementById('weekOrders').textContent = weekOrders;

            const weekAvg = Math.round(weekRevenue / 7);
            document.getElementById('weekAvg').textContent = `$${weekAvg.toLocaleString()}`;

            // 7å¤©è¶¨å‹¢åœ–
            const weekTrendChartEl = document.getElementById('weekTrendChart');
            weekTrendChartEl.innerHTML = '';

            const days = ['é€±ä¸€', 'é€±äºŒ', 'é€±ä¸‰', 'é€±å››', 'é€±äº”', 'é€±å…­', 'é€±æ—¥'];
            const trendData = [7500, 8200, 7800, 8500, 9100, 8800, dailyStats.totalRevenue || 8500];
            const maxTrend = Math.max(...trendData);

            days.forEach((day, index) => {
                const height = (trendData[index] / maxTrend) * 150;

                const bar = document.createElement('div');
                bar.className = 'trend-bar';
                bar.innerHTML = `
                    <div class="trend-bar-value">$${(trendData[index] / 1000).toFixed(1)}k</div>
                    <div class="trend-bar-fill" style="height: ${height}px"></div>
                    <div class="trend-bar-label">${day}</div>
                `;
                weekTrendChartEl.appendChild(bar);
            });
        }

        // æ›´æ–°æœˆå ±è¡¨
        function updateMonthlyReport() {
            // æ¨¡æ“¬æœˆçµ±è¨ˆ
            const monthRevenue = dailyStats.totalRevenue + 245600;
            const monthOrders = dailyStats.orderCount + 1156;

            document.getElementById('monthRevenue').textContent = `$${monthRevenue.toLocaleString()}`;
            document.getElementById('monthOrders').textContent = monthOrders;

            const daysInMonth = new Date(new Date().getFullYear(), new Date().getMonth() + 1, 0).getDate();
            const monthAvg = Math.round(monthRevenue / daysInMonth);
            document.getElementById('monthAvg').textContent = `$${monthAvg.toLocaleString()}`;

            // æœˆåº¦è¶¨å‹¢åœ–ï¼ˆé¡¯ç¤ºå‰15å¤©ï¼‰
            const monthTrendChartEl = document.getElementById('monthTrendChart');
            monthTrendChartEl.innerHTML = '';

            for (let day = 1; day <= 15; day++) {
                const revenue = 7000 + Math.random() * 4000; // æ¨¡æ“¬è³‡æ–™
                const height = (revenue / 12000) * 150;

                const bar = document.createElement('div');
                bar.className = 'trend-bar';
                bar.innerHTML = `
                    <div class="trend-bar-value">$${Math.round(revenue / 1000)}k</div>
                    <div class="trend-bar-fill" style="height: ${height}px"></div>
                    <div class="trend-bar-label">${day}</div>
                `;
                monthTrendChartEl.appendChild(bar);
            }
        }

        // éš±è—å ±è¡¨é é¢
        function hideReports() {
            document.getElementById('mainPage').style.display = 'block';
            document.getElementById('reportsPage').classList.remove('active');
            document.getElementById('settingsPage').classList.remove('active');
        }

        // é¡¯ç¤ºè¨­å®šé é¢
        function showSettings() {
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('reportsPage').classList.remove('active');
            document.getElementById('settingsPage').classList.add('active');
            updateDiscountRulesList();
        }

        // éš±è—è¨­å®šé é¢
        function hideSettings() {
            document.getElementById('settingsPage').classList.remove('active');
            document.getElementById('reportsPage').classList.remove('active');
            document.getElementById('mainPage').style.display = 'block';
        }

        // æ›´æ–°æŠ˜æ‰£è¦å‰‡åˆ—è¡¨
        function updateDiscountRulesList() {
            const listContainer = document.getElementById('discountRulesList');
            listContainer.innerHTML = '';

            if (discountRules.length === 0) {
                listContainer.innerHTML = `
                    <div class="empty-rules">
                        <div class="empty-rules-icon">ğŸ·ï¸</div>
                        <p>å°šæœªè¨­å®šæŠ˜æ‰£è¦å‰‡</p>
                        <p style="font-size: 14px; margin-top: 8px;">é»æ“Šä¸‹æ–¹æŒ‰éˆ•æ–°å¢å„ªæƒ è¦å‰‡</p>
                    </div>
                `;
                return;
            }

            discountRules.forEach(rule => {
                const ruleCard = document.createElement('div');
                ruleCard.className = 'discount-rule-card';

                let title, desc, typeBadge;

                if (rule.type === 'item') {
                    typeBadge = '<span class="badge badge-item">å–®ä¸€å“é …</span>';
                    title = rule.itemName;
                    desc = `è²· ${rule.quantity} ä¸² æŠ˜ $${rule.discountAmount}`;
                } else if (rule.type === 'category') {
                    typeBadge = '<span class="badge badge-category">åˆ†é¡æŠ˜æ‰£</span>';
                    title = `${categoryNames[rule.categoryId]}é¡`;
                    desc = `è²· ${rule.quantity} ä¸² æŠ˜ $${rule.discountAmount}`;
                } else if (rule.type === 'total') {
                    typeBadge = '<span class="badge badge-total">ç¸½æ•¸é‡</span>';
                    title = 'å…¨é¤¨å•†å“';
                    desc = `è²· ${rule.quantity} ä¸² æŠ˜ $${rule.discountAmount}`;
                }

                ruleCard.innerHTML = `
                    <div class="discount-rule-info">
                        <div class="discount-rule-title">${typeBadge} ${title}</div>
                        <div class="discount-rule-desc">${desc}</div>
                    </div>
                    <div class="discount-rule-actions">
                        <button class="discount-rule-btn btn-edit" onclick="editDiscountRule(${rule.id})">ç·¨è¼¯</button>
                        <button class="discount-rule-btn btn-delete" onclick="deleteDiscountRule(${rule.id})">åˆªé™¤</button>
                    </div>
                `;
                listContainer.appendChild(ruleCard);
            });
        }

        // é¡¯ç¤ºæ–°å¢æŠ˜æ‰£è¦å‰‡å½ˆçª—
        function showAddDiscountModal() {
            editingDiscountId = null;
            document.getElementById('discountModalTitle').textContent = 'æ–°å¢æŠ˜æ‰£è¦å‰‡';

            // å¡«å……å“é …é¸é …
            const itemSelect = document.getElementById('discountItem');
            itemSelect.innerHTML = menuItems.map(item =>
                `<option value="${item.id}">${item.name} - $${item.price}</option>`
            ).join('');

            // é‡è¨­è¡¨å–®
            document.getElementById('discountType').value = 'item';
            document.getElementById('discountQuantity').value = 3;
            document.getElementById('discountAmount').value = 5;
            onDiscountTypeChange();
            updateDiscountPreview();

            document.getElementById('discountModal').classList.add('active');
        }

        // æŠ˜æ‰£é¡å‹è®Šæ›´è™•ç†
        function onDiscountTypeChange() {
            const type = document.getElementById('discountType').value;
            const desc = discountTypes[type].desc;

            document.getElementById('discountTypeDesc').textContent = desc;

            // é¡¯ç¤º/éš±è—å°æ‡‰çš„é¸æ“‡å™¨
            document.getElementById('itemSelectGroup').style.display = type === 'item' ? 'block' : 'none';
            document.getElementById('categorySelectGroup').style.display = type === 'category' ? 'block' : 'none';

            updateDiscountPreview();
        }

        // ç·¨è¼¯æŠ˜æ‰£è¦å‰‡
        function editDiscountRule(id) {
            const rule = discountRules.find(r => r.id === id);
            if (!rule) return;

            editingDiscountId = id;
            document.getElementById('discountModalTitle').textContent = 'ç·¨è¼¯æŠ˜æ‰£è¦å‰‡';

            // è¨­å®šæŠ˜æ‰£é¡å‹
            document.getElementById('discountType').value = rule.type;
            onDiscountTypeChange();

            // å¡«å……å“é …é¸é …
            const itemSelect = document.getElementById('discountItem');
            itemSelect.innerHTML = menuItems.map(item =>
                `<option value="${item.id}">${item.name} - $${item.price}</option>`
            ).join('');

            // æ ¹æ“šé¡å‹è¨­å®šå€¼
            if (rule.type === 'item') {
                itemSelect.value = rule.itemId;
            } else if (rule.type === 'category') {
                document.getElementById('discountCategory').value = rule.categoryId;
            }

            document.getElementById('discountQuantity').value = rule.quantity;
            document.getElementById('discountAmount').value = rule.discountAmount;
            updateDiscountPreview();

            document.getElementById('discountModal').classList.add('active');
        }

        // åˆªé™¤æŠ˜æ‰£è¦å‰‡
        function deleteDiscountRule(id) {
            if (confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹æŠ˜æ‰£è¦å‰‡å—ï¼Ÿ')) {
                discountRules = discountRules.filter(r => r.id !== id);
                updateDiscountRulesList();
                updateCart(); // æ›´æ–°è³¼ç‰©è»Šä»¥åæ˜ æŠ˜æ‰£è®ŠåŒ–
            }
        }

        // éš±è—æŠ˜æ‰£è¦å‰‡å½ˆçª—
        function hideDiscountModal() {
            document.getElementById('discountModal').classList.remove('active');
        }

        // æ›´æ–°æŠ˜æ‰£é è¦½
        function updateDiscountPreview() {
            const type = document.getElementById('discountType').value;
            const quantity = parseInt(document.getElementById('discountQuantity').value) || 3;
            const discountAmount = parseInt(document.getElementById('discountAmount').value) || 5;

            let previewText = '';

            if (type === 'item') {
                const itemId = parseInt(document.getElementById('discountItem').value);
                const item = menuItems.find(i => i.id === itemId);
                const itemName = item ? item.name : 'å•†å“';
                previewText = `${itemName} è²·${quantity}ä¸² æŠ˜$${discountAmount}`;
            } else if (type === 'category') {
                const categoryId = document.getElementById('discountCategory').value;
                const categoryName = categoryNames[categoryId];
                previewText = `${categoryName}é¡ è²·${quantity}ä¸² æŠ˜$${discountAmount}`;
            } else if (type === 'total') {
                previewText = `å…¨é¤¨å•†å“ è²·${quantity}ä¸² æŠ˜$${discountAmount}`;
            }

            document.getElementById('discountPreviewText').textContent = previewText;
        }

        // å„²å­˜æŠ˜æ‰£è¦å‰‡
        function saveDiscountRule() {
            const type = document.getElementById('discountType').value;
            const quantity = parseInt(document.getElementById('discountQuantity').value);
            const discountAmount = parseInt(document.getElementById('discountAmount').value);

            if (!quantity || quantity < 1) {
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„è³¼è²·æ•¸é‡');
                return;
            }

            if (!discountAmount || discountAmount < 1) {
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„æŠ˜æ‰£é‡‘é¡');
                return;
            }

            let ruleData = {
                type: type,
                quantity: quantity,
                discountAmount: discountAmount
            };

            // æ ¹æ“šé¡å‹è¨­å®šç‰¹å®šè³‡æ–™
            if (type === 'item') {
                const itemId = parseInt(document.getElementById('discountItem').value);
                const item = menuItems.find(i => i.id === itemId);
                ruleData.itemId = itemId;
                ruleData.itemName = item.name;
            } else if (type === 'category') {
                ruleData.categoryId = document.getElementById('discountCategory').value;
            }

            if (editingDiscountId) {
                // ç·¨è¼¯ç¾æœ‰è¦å‰‡
                const rule = discountRules.find(r => r.id === editingDiscountId);
                if (rule) {
                    Object.assign(rule, ruleData);
                }
            } else {
                // æ–°å¢è¦å‰‡
                const newId = Math.max(...discountRules.map(r => r.id), 0) + 1;
                discountRules.push({
                    id: newId,
                    ...ruleData
                });
            }

            hideDiscountModal();
            updateDiscountRulesList();
            updateCart();
        }

        // é˜²æ­¢è§¸æ§ç¸®æ”¾å’Œæ‰‹å‹¢æ“ä½œ
        document.addEventListener('touchstart', function(event) {
            if (event.touches.length > 1) {
                // é˜²æ­¢å¤šæŒ‡è§¸æ§ç¸®æ”¾
                event.preventDefault();
            }
        }, { passive: false });

        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(event) {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) {
                // é˜²æ­¢é›™æ“Šç¸®æ”¾
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // é˜²æ­¢æ‰‹å‹¢ç¸®æ”¾
        document.addEventListener('gesturestart', function(event) {
            event.preventDefault();
        });

        // å„ªåŒ–å¿«é€Ÿé‡‘é¡æŒ‰éˆ•çš„è§¸æ§éŸ¿æ‡‰
        document.addEventListener('DOMContentLoaded', () => {
            const quickAmountBtns = document.querySelectorAll('.quick-amount-btn');

            quickAmountBtns.forEach(btn => {
                // ä½¿ç”¨ touchstart äº‹ä»¶ä¾†æ¶ˆé™¤ 300ms å»¶é²
                btn.addEventListener('touchstart', function(e) {
                    e.preventDefault(); // é˜²æ­¢è§¸ç™¼å¾ŒçºŒçš„ click äº‹ä»¶

                    // æ·»åŠ æŒ‰ä¸‹è¦–è¦ºæ•ˆæœ
                    this.classList.add('pressed');

                    // ä½¿ç”¨ vibration API æä¾›è§¸è¦ºå›é¥‹ï¼ˆå¦‚æœæ”¯æ´ï¼‰
                    if (navigator.vibrate) {
                        navigator.vibrate(10); // è¼•å¾®éœ‡å‹• 10ms
                    }

                    // å–å¾— onclick å±¬æ€§ä¸­çš„å‡½æ•¸åç¨±å’Œåƒæ•¸
                    const onclickValue = this.getAttribute('onclick');
                    if (onclickValue) {
                        // è§£æä¸¦åŸ·è¡Œå‡½æ•¸
                        // ä¾‹å¦‚ï¼šaddAmount(100) -> åŸ·è¡Œ addAmount(100)
                        const match = onclickValue.match(/(\w+)\(([^)]*)\)/);
                        if (match) {
                            const funcName = match[1];
                            const args = match[2] ? match[2].split(',').map(arg => {
                                arg = arg.trim();
                                // ç§»é™¤å¼•è™Ÿï¼ˆå­—ä¸²åƒæ•¸ï¼‰
                                if ((arg.startsWith("'") && arg.endsWith("'")) ||
                                    (arg.startsWith('"') && arg.endsWith('"'))) {
                                    return arg.slice(1, -1);
                                }
                                // æ•¸å­—åƒæ•¸
                                return isNaN(arg) ? arg : parseInt(arg);
                            }) : [];

                            // åŸ·è¡Œå°æ‡‰çš„å‡½æ•¸
                            if (typeof window[funcName] === 'function') {
                                window[funcName](...args);
                            }
                        }
                    }
                }, { passive: false });

                // ç§»é™¤æŒ‰ä¸‹ç‹€æ…‹
                btn.addEventListener('touchend', function(e) {
                    e.preventDefault();
                    this.classList.remove('pressed');
                }, { passive: false });

                // å¦‚æœè§¸æ§å–æ¶ˆï¼Œä¹Ÿè¦ç§»é™¤æŒ‰ä¸‹ç‹€æ…‹
                btn.addEventListener('touchcancel', function(e) {
                    this.classList.remove('pressed');
                });
            });
        });

        // ç›£è½è¼¸å…¥è®ŠåŒ–ä»¥æ›´æ–°é è¦½
        document.addEventListener('DOMContentLoaded', () => {
            const inputs = ['discountItem', 'discountQuantity', 'discountAmount'];
            inputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', updateDiscountPreview);
                    element.addEventListener('input', updateDiscountPreview);
                }
            });
        });

        // åˆå§‹åŒ–
        window.onload = () => {
            initMenu();
            initCategoryTabs();
        };
    </script>
</body>
</html>
